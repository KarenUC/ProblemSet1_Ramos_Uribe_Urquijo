### --- Estadisticas Descriptivas --- ###
library(sjPlot)
library(stargazer)
graph_base <- as.data.frame(Base_var)
stargazer(graph_base[c("ingtot", "age", "p6426" )], type="text", flip = TRUE, digits = 0)
stargazer(graph_base[c("ingtot", "age", "p6426" )], type="latex", flip = TRUE, digits = 0)
stargazer(graph_base[c("ingtot", "age", "p6426" )], type='text', flip = TRUE,
digits=0, header=FALSE,
summary.stat=c('N', 'mean', 'sd','min' ,'median', 'max'))
stargazer(graph_base[c("ingtot", "age", "p6426")], type='latex', flip = TRUE,
digits=0, header=FALSE,
summary.stat=c('N', 'mean', 'sd','min' ,'median', 'max'))
# Graficas
# Ingresos vs. estrato y sexo
box_plot <- ggplot(data=Base_var , mapping = aes(as.factor(estrato1) , ingtot)) +
geom_boxplot()
box_plot <- box_plot +
geom_point(aes(colour=as.factor(sex))) +
scale_color_manual(values = c("0"="red" , "1"="blue") ,
label = c("0"="Hombre" , "1"="Mujer") ,
name = "Sexo") +
labs(x= "Estrato Socioecon?mico", y ="Ingresos Totales")
box_plot_boxcox<- ggplot(data=Base_var , mapping = aes(as.factor(estrato1) , ingtot_boxcox)) +
geom_boxplot()
box_plot_boxcox <- box_plot_boxcox +
geom_point(aes(colour=as.factor(sex))) +
scale_color_manual(values = c("0"="red" , "1"="blue") ,
label = c("0"="Hombre" , "1"="Mujer") ,
name = "Sexo") +
labs(x= "Estrato Socioecon?mico", y ="Ingresos Totales (boxcox)")
box_plot_boxcox
# Densidad Ingresos por formal, informal
graph2 <- ggplot(data = Base_var ,
mapping = aes(x = age , y = ingtot , group=as.factor(formal))) +
geom_point(aes(colour=as.factor(formal))) +
scale_color_manual(values = c("0"="cadetblue3" , "1"="coral") ,
label = c("0"="Informal" , "1"="Formal") ,
name = "Formal") +
labs(x = "Edad", y = "Ingresos Totales")
graph2
graph2_boxcox <- ggplot(data = Base_var ,
mapping = aes(x = age , y = ingtot_boxcox , group=as.factor(formal))) +
geom_point(aes(colour=as.factor(formal))) +
scale_color_manual(values = c("0"="cadetblue3" , "1"="coral") ,
label = c("0"="Informal" , "1"="Formal") ,
name = "Formal") +
labs(x = "Edad", y = "Ingresos Totales")
graph2_boxcox
###--- 3. Age-earnings profile
## Escoger variable para salario
# Se escoge la variable ingresos totales después de revisar la base, dado que
#es la suma del ingreso total + el ingreso imputado (ingresos adicionales)
library(jtools)
##  OLS Age-earnings model - sin transformación
Base_var$age_2 <- (Base_var$age)^2
model_income<-lm(ingtot~age + age_2,
data= Base_var)
summ(model_income)
##  OLS Age-earnings model - Con trasformación boxcox
model_income_boxcox<-lm(ingtot_boxcox~age + age_2,
data= Base_var)
summ(model_income_boxcox)
#Comparar modelos
stargazer(model_income, model_income_boxcox, type = "text")
### Qué tan bueno es el fit del modelo?
#El fit es malo según Rcuadrado - Revisar argumento
# Guardar los predichos del modelo en datos
Base_var$nuevo_pred <- model_income$fitted.values
# Guardar los residuos
Base_var$residuos <- model_income$residuals
plot1 <- ggplot(Base_var,                                     # Draw plot using ggplot2 package
aes(x = Base_var$nuevo_pred,
y = Base_var$ingtot)) +
geom_point(colour= "gray") +
geom_abline(intercept = 0,
slope = 1,
color = "green",
size = 2) +
labs(x= "Ingreso Total Observado", y= "Ingreso Total Predicho")
plot2 <- ggplot(Base_var,                                     # Draw plot using ggplot2 package
aes(x = Base_var$ingtot_boxcox,
y = predict(model_income_boxcox)) +
geom_point(colour= "gray") +
geom_abline(intercept = 0,
slope = 1,
color = "green",
size = 2) +
labs(x= "Ingreso Total Observado - Transofrmaci?n Box-cox", y= "Ingreso Total Predicho - Transformaci?n Box-cox"))
ggarrange(plot1, plot2)
#Plot the predicted age-earnings profile implied by the above equation.
Base_var$prediccion1<-predict(model_income)
Base_var$prediccion1_boxcox<-predict(model_income_boxcox)
########
#Graficas predicci?n y valor observado
cor(Base_var$ingtot,Base_var$prediccion1)
ggplot(Base_var, aes(x = prediccion1, y = ingtot)) +
geom_point() +
geom_abline(intercept = 0, slope = 1, color = "green")
g1<-ggplot(Base_var, aes(x = age, y = ingtot)) + geom_point(colour = "darkcyan") + labs(x = "Edad", y = "Ingresos Totales")
g2<-ggplot(Base_var, aes(x = age, y = prediccion1)) + geom_point(colour = "violetred2") + labs(x = "Edad", y = "Ingresos Totales Predicha")
cor(Base_var$ingtot_boxcox,Base_var$prediccion1_boxcox)
ggplot(Base_var, aes(x = prediccion1, y = ingtot_boxcox)) +
geom_point() + geom_abline(intercept = 0, slope = 1, color = "blue")
g2_boxcox<-ggplot(Base_var, aes(x = age, y = prediccion1_boxcox)) + geom_point(colour = "violetred2") + labs(x = "Edad", y = "Ingresos Totales Predicha - Boxcox")
ggarrange(g1, g2, g2_boxcox, nrow = 1, ncol = 3)
#### Encontrar medida de incertidumbre para los coeficientes del modelo
p_load(boot)
R<-1000
fun<-function(Base_var,index){
coef(lm(ingtot~age + age_2, data= Base_var, subset = index))
}
boot(Base_var, fun, R)
## Edad optima
b1<-model_income$coefficients[2]
b2<-model_income$coefficients[3]
edad_optima<--(b1/(2*b2))
edad_optima ##56
fun2<-function(Base_var,index){
coef(lm(ingtot_boxcox~age + age_2, data= Base_var, subset = index))
}
boot(Base_var, fun, R)
## Edad optima
b1_boxcox<-model_income_boxcox$coefficients[2]
b2_boxcox<-model_income_boxcox$coefficients[3]
edad_optima_boxcox<--(b1_boxcox/(2*b2_boxcox))
edad_optima
edad_optima_boxcox#44
#Intervalos de confianza
CI_age<-confint(model_income, level=0.95)
CI_age_boxcox<-confint(model_income_boxcox, level=0.95)
CI_age
CI_age_boxcox
###--- 4. The earnings GAP ---###########
#### Crear variable female y log income
Base_var = Base_var %>%
mutate(female = ifelse(sex == 0,1,0))
Base_var$log_income<-log(Base_var$ingtot)
Base_var$female<-as.factor(Base_var$female)
skim(Base_var$log_income)
#Validar es si hay NAS
sum(is.na(Base_var$female))
sum(is.na(Base_var$log_income))
#Modelo unconditional earnings gap
model_income_female<-lm(log_income~female, data= Base_var)
summ(model_income_female)
stargazer(model_income_female, type = "text")
stargazer(model_income_female, type = "latex")
##Qué tan bueno es el modelo? Interpretación del R2
##Estimar y graficar the predicted age-earnings profile by gender
model_income_age_female <-lm(ingtot~age + age_2,data=subset(Base_var,female==1))
summary(model_income_age_female)
model_income_age_male <-lm(ingtot~age + age_2,data=subset(Base_var,female==0))
summary(model_income_age_male)
stargazer(model_income_age_female, model_income_age_male, type = "text")
##los coeficientes son diferentes para hombres y mujeres; pero el intercepto es muy parecido
#### Encontrar medida de incertidumbre para los coeficientes del modelo
R<-1000
fun_female<-function(Base_var,index){
coef(lm(ingtot~age + age_2,data=subset(Base_var,female==1), subset = index))
}
boot(Base_var, fun_female, R)
## Edad optima
b1_female<-model_income_age_female$coefficients[2]
b2_female<-model_income_age_female$coefficients[3]
edad_optima_female<--(b1_female/(2*b2_female))
edad_optima_female ##55
fun_male<-function(Base_var,index){
coef(lm(ingtot~age + age_2,data=subset(Base_var,female==0), subset = index))
}
boot(Base_var, fun_male, R)
## Edad optima
b1_male<-model_income_age_male$coefficients[2]
b2_male<-model_income_age_male$coefficients[3]
edad_optima_male<--(b1_male/(2*b2_male))
edad_optima_male ##54
#Intervalos de confianza
CI_age_female<-confint(model_income_age_female, level=0.95)
CI_age_male<-confint(model_income_age_male, level=0.95)
CI_age_female
CI_age_male
##Calculo de predicciones
Base_var$predict_gender<-ifelse(Base_var$female==1, predict(model_income_age_female), predict(model_income_age_male))
#Graficar predicciones para hombre y para mujer
Base_gender_female<-subset(Base_var, female==1)
Base_gender_female$female_pred<-predict(model_income_age_female)
g_female_p<-ggplot(Base_gender_female, aes(x = age, y = female_pred)) + geom_point(colour = "orange1") + labs(x = "Edad", y = "Ingresos Totales Predicha Mujer")
Base_gender_male<-subset(Base_var, female==0)
Base_gender_male$male_pred<-predict(model_income_age_male)
g_male_p<-ggplot(Base_gender_male, aes(x = age, y = male_pred)) + geom_point(colour = "steelblue1") + labs(x = "Edad", y = "Ingresos Totales Predicha Hombre")
ggarrange(g1, g_female_p, g_male_p, nrow = 1, ncol = 3)
####----Equal Pay for Equal Work?-----###
#Modelo unconditional earnings gap con controles
#p6426 = ¿cuanto tiempo lleva ... Trabajando en esta empresa, negocio, industria, oficina
################################################################
#Modelo unconditional earnings gap con controles
model_controls<-lm(log_income~female +
formal + age + age_2 + estrato1
+ maxEducLevel + p6426, data= Base_var)
summ(model_controls)
stargazer(model_controls, type = "text")
##Teorema FWL
##Estimación del modelo con los residuales
#Modelo sin incluir variable de interes
y_controles<-lm(log_income~ formal + age + age_2 + estrato1
+ maxEducLevel + p6426, data= Base_var)
summ(y_controles)
Base_var = Base_var %>%
mutate(femalenum = ifelse(sex == 0,1,0))
class(Base_var$femalenum)
female_controles<-lm(femalenum~ formal + age + age_2 + estrato1
+ maxEducLevel + p6426, data= Base_var)
summ(female_controles)
Base_var$res_y= y_controles$residuals
Base_var$res_f= female_controles$residuals
reg_final<-lm(res_y~ res_f, data=Base_var)
summ(reg_final)
stargazer(model_controls, reg_final, type = "text")
stargazer(model_controls, reg_final, type = "latex")
###Falta la interpretación!!!!!
###############
##### Transformación para encontrar experiencia potencial
# Es complicado encontrar una variable que muestre cuántos años ha trabajado una persona en realidad.
#Por ello, en la literatura se ha utilizado como proxy de la experiencia la experiencia potencial.
#Esta nace de restarle a la edad de la persona los años que ha estudiado y,
#además, cinco (5) años -pues en sus años de primera infancia ni estudió ni trabajó.
#p6210 = ¿Cuál es el nivel educativo más alto alcanzado por .... y el último año o grado
#maxEducLevel = 	max. education level attained
Base_var<- Base_var %>% mutate(maxEducLevel_years = ifelse(maxEducLevel==1, 0,
ifelse(maxEducLevel==2, 1,
ifelse(maxEducLevel==3, 4,
ifelse(maxEducLevel==4, 5,
ifelse(maxEducLevel==5, 10,
ifelse(maxEducLevel==6, 11,
ifelse(maxEducLevel==7, 15,
ifelse(maxEducLevel==9, NA, NA)))))))))
Base_var<- Base_var %>% mutate(p6210_years = ifelse(p6210==1, 0,
ifelse(p6210==2, 1,
ifelse(p6210==3, 5,
ifelse(p6210==4, 9,
ifelse(p6210==5, 13,
ifelse(p6210==6, 19,
ifelse(p6210==9, 0,0))))))))
Base_var<- Base_var %>% mutate(exp_pot_maxedu = age - maxEducLevel_years - 5)
Base_var<- Base_var %>% mutate(exp_pot_p6210 = age - p6210_years - 5)
Base_var<- Base_var %>% mutate(exp_pot_p6210 = ifelse(exp_pot_p6210>=0,exp_pot_p6210, 0))
a1<-ggplot(Base_var, aes(x = p6210, y = ingtot)) + geom_point()
a2<-ggplot(Base_var, aes(x = maxEducLevel, y = ingtot)) + geom_point()
a3<-ggplot(Base_var, aes(x = exp_pot_p6210, y = ingtot)) + geom_point()
a4<-ggplot(Base_var, aes(x = exp_pot_maxedu, y = ingtot)) + geom_point()
ggarrange(a1, a2, a3, a4, nrow = 2, ncol = 2)
skim(Base_var$p6210)
skim(Base_var$maxEducLevel)
Base_var$exp_pot_p6210_2 <- Base_var$exp_pot_p6210^2
#### ----- 5.Predicting Earnigns
set.seed(10101)
##Dividir muestra
sample <- sample.int(n = nrow(Base_var), size = floor(.70*nrow(Base_var)), replace = F)
train <- Base_var[sample, ]
test  <- Base_var[-sample, ]
##Estimar modelo solo incluyendo la constante - Benchmark
model_cte<-lm(ingtot~1,data=train)
summary(model_cte)
stargazer(model_cte, type = "text")
coef(model_cte)
mean(train$ingtot)
##Estimar los modelos anteriores
##1. Age
model_ing_train<-lm(ingtot~age + age_2,
data= train)
summ(model_ing_train)
##2. Female
model_ing_fem_train<-lm(log_income~female, data= train)
summ(model_ing_fem_train)
##3. Female and controls
model_cont_train<-lm(log_income~female +
formal + age + age_2 + estrato1
+ maxEducLevel + p6426, data= train)
summ(model_cont_train)
stargazer(model_ing_train, model_ing_fem_train, model_cont_train , type = "text")
#################### Discutir modelos
test$model_cte_p<-predict(model_cte,newdata = test)
MSE_ingtot_cte<-with(test,mean((ingtot-model_cte_p)^2))
test$model_ing_p<-predict(model_ing_train,newdata = test)
MSE_ingtot_age<-with(test,mean((ingtot-model_ing_p)^2))
test$model_ing_fem_p<-predict(model_ing_fem_train,newdata = test)
MSE_logincome_fem<-with(test,mean((ingtot-model_ing_fem_p)^2))
test$model_cont_p<-predict(model_cont_train,newdata = test)
MSE_logincome_fem_controls<-with(test,mean((ingtot-model_cont_p)^2))
MSE<-rbind(MSE_ingtot_cte, MSE_ingtot_age, MSE_logincome_fem, MSE_logincome_fem_controls)
min(MSE)
#####################
### ----- 5 models ----#######
##1_Educación y experiencia
train$experiencia_2<-train$p6426^2
model_1_train<-lm(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2,
data= train)
summ(model_1_train)
stargazer(model_1_train , type = "text")
##2_Horas de trabajo y segundo trabajo (p7040)
train<-train %>% mutate(dos_trabajo = ifelse(p7040==2, 0,1))
model_2_train<-lm(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo,
data= train)
summ(model_2_train)
stargazer(model_2_train , type = "text")
##3_Sexo,Cuenta propia e informal
model_3_train<-lm(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal,
data= train)
summ(model_3_train)
stargazer(model_3_train , type = "text")
##4 Microempresa, tamaño de la firma, relación laboral
model_4_train<-lm(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab,
data= train)
summ(model_4_train)
stargazer(model_4_train , type = "text")
##5 Age, college*sex y relab, edad
train[train$oficio==0 , ]
model_5_train<-lm(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab+ age + female + college:female ,
data= train)
summ(model_5_train)
stargazer(model_5_train , type = "text")
stargazer(model_1_train,model_2_train,model_3_train,model_4_train,model_5_train, type = "text")
#table(Base_var$sizeFirm)
#levels(Base_var$oficio)
#lm(ingtot_boxcox~relab, train)
#lm(ingtot_boxcox~sizeFirm, train)
#levels(train$relab)
#levels(train$sizeFirm)
##Reportar y comparar el error medio de predicción de los 8 modelos
residuals1<-mean(model_ing_train$residuals)
residuals2<-mean(model_ing_fem_train$residuals)
residuals3<-mean(model_cont_train$residuals)
residuals4<-mean(model_1_train$residuals)
residuals5<-mean(model_2_train$residuals)
residuals6<-mean(model_3_train$residuals)
residuals7<-mean(model_4_train$residuals)
residuals8<-mean(model_5_train$residuals)
table1<-rbind(residuals1,residuals2, residuals3, residuals4, residuals5, residuals6, residuals7, residuals8)
colnames(table1) <- c("value")
min(table1) ##Lowest average prediction error_ modelo_1_train (Modelo de mincer educación y experiencia)
test<-test %>% mutate(dos_trabajo = ifelse(p7040==2, 0,1))
test$model_1_p<-predict(model_1_train,newdata = test)
MSE_model_1<-with(test,mean((ingtot_boxcox-model_1_p)^2))
test$model_2_p<-predict(model_2_train,newdata = test)
MSE_model_2<-with(test,mean((ingtot_boxcox-model_2_p)^2))
test$model_3_p<-predict(model_3_train,newdata = test)
MSE_model_3<-with(test,mean((ingtot_boxcox-model_3_p)^2))
test$model_4_p<-predict(model_4_train,newdata = test)
MSE_model_4<-with(test,mean((ingtot_boxcox-model_4_p)^2))
test$model_5_p<-predict(model_5_train,newdata = test)
MSE_model_5<-with(test,mean((ingtot_boxcox-model_5_p)^2))
##5 Age, college*sex y relab, edad
model_5_train<-lm(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab+ age + female + college:female ,
data= train)
###### Discutir modelos en TEST SAMPLE
test<-test %>% mutate(dos_trabajo = ifelse(p7040==2, 0,1))
test<-test %>% mutate(dos_trabajo = ifelse(p7040==2, 0,1))
test$model_1_p<-predict(model_1_train,newdata = test)
MSE_model_1<-with(test,mean((ingtot_boxcox-model_1_p)^2))
test$model_2_p<-predict(model_2_train,newdata = test)
MSE_model_2<-with(test,mean((ingtot_boxcox-model_2_p)^2))
test$model_3_p<-predict(model_3_train,newdata = test)
MSE_model_3<-with(test,mean((ingtot_boxcox-model_3_p)^2))
test$model_4_p<-predict(model_4_train,newdata = test)
MSE_model_4<-with(test,mean((ingtot_boxcox-model_4_p)^2))
test$model_5_p<-predict(model_5_train,newdata = test)
MSE_model_5<-with(test,mean((ingtot_boxcox-model_5_p)^2))
MSE<-rbind(MSE_ingtot_cte, MSE_ingtot_age, MSE_logincome_fem, MSE_logincome_fem_controls,
MSE_model_1, MSE_model_2, MSE_model_3, MSE_model_4, MSE_model_5)
min(MSE)
MSE_2<-rbind(MSE_model_1, MSE_model_2, MSE_model_3, MSE_model_4, MSE_model_5)
min(MSE_2)
p_load(caret)
modelcte1<-lm(ingtot_boxcox~1,data=train)
summary(modelcte1)
stargazer(modelcte1, type = "text")
coef(modelcte1)
mean(train$ingtot_boxcox)
RMSE_modelcte1<-with(test,mean((ingtot_boxcox-coef(modelcte1))^2))
model1 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model2 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model3 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model4 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model5 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab+ age + female + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
kfold_RMSE<-rbind(model1$results,model2$results,model3$results,model4$results,model5$results)
kfold_RMSE$name<-rbind("model1","model2","model3", "model4", "model5")
ggplot(kfold_RMSE, aes(x = name, y = RMSE)) + geom_line()+ geom_point()
###### Discutir modelos en TEST SAMPLE
test<-test %>% mutate(dos_trabajo = ifelse(p7040==2, 0,1))
test$model_1_p<-predict(model_1_train,newdata = test)
MSE_model_1<-with(test,mean((ingtot_boxcox-model_1_p)^2))
test$model_2_p<-predict(model_2_train,newdata = test)
MSE_model_2<-with(test,mean((ingtot_boxcox-model_2_p)^2))
test$model_3_p<-predict(model_3_train,newdata = test)
MSE_model_3<-with(test,mean((ingtot_boxcox-model_3_p)^2))
test$model_4_p<-predict(model_4_train,newdata = test)
MSE_model_4<-with(test,mean((ingtot_boxcox-model_4_p)^2))
test$model_5_p<-predict(model_5_train,newdata = test)
MSE_model_5<-with(test,mean((ingtot_boxcox-model_5_p)^2))
MSE<-rbind(MSE_ingtot_cte, MSE_ingtot_age, MSE_logincome_fem, MSE_logincome_fem_controls,
MSE_model_1, MSE_model_2, MSE_model_3, MSE_model_4, MSE_model_5)
min(MSE)
MSE_2<-rbind(MSE_model_1, MSE_model_2, MSE_model_3, MSE_model_4, MSE_model_5)
min(MSE_2)
### ----- K-fold Validación cruzada ------#####
p_load(caret)
modelcte1<-lm(ingtot_boxcox~1,data=train)
summary(modelcte1)
stargazer(modelcte1, type = "text")
coef(modelcte1)
mean(train$ingtot_boxcox)
RMSE_modelcte1<-with(test,mean((ingtot_boxcox-coef(modelcte1))^2))
model1 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model2 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
Base_var<-Base_var %>% mutate(dos_trabajo = ifelse(p7040==2, 0,1))
model1 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model2 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model3 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model2 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model3 <- train(ingtot_boxcox ~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model4 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model5 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal
+microEmpresa + sizeFirm + relab+ age + female + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
kfold_RMSE<-rbind(model1$results,model2$results,model3$results,model4$results,model5$results)
kfold_RMSE$name<-rbind("model1","model2","model3", "model4", "model5")
ggplot(kfold_RMSE, aes(x = name, y = RMSE)) + geom_line()+ geom_point()
model6 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + poly(cuentaPropia,8) + informal:age
+microEmpresa + poly(sizeFirm,7) + relab+ age + female + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model6 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal:age
+microEmpresa + poly(sizeFirm,7) + relab+ poly(age,8) + female + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model6 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+hoursWorkUsual + dos_trabajo + female + cuentaPropia + informal:age
+microEmpresa + sizeFirm + relab+ poly(age,8) + female + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
model6 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+poly(hoursWorkUsual,9) + dos_trabajo + female + cuentaPropia + informal:age
+microEmpresa + sizeFirm + relab+ poly(age,8) + female:cuentaPropia + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
kfold_RMSE<-rbind(model1$results,model2$results,model3$results,model4$results,model5$results, model6$results,)
model6 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+poly(hoursWorkUsual,9) + dos_trabajo + female + cuentaPropia + informal:age
+microEmpresa + sizeFirm + relab+ poly(age,8) + female:cuentaPropia + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
kfold_RMSE<-rbind(model1$results,model2$results,model3$results,model4$results,model5$results, model6$results,)
View(kfold_RMSE)
model6 <- train(ingtot_boxcox~ maxEducLevel + exp_pot_p6210 + exp_pot_p6210_2
+poly(hoursWorkUsual,9) + dos_trabajo + female + cuentaPropia + informal:age
+microEmpresa + sizeFirm + relab+ poly(age,8) + female:cuentaPropia + college:female ,
data = Base_var, trControl = trainControl(method = "cv", number = 5),
method = "lm")
kfold_RMSE<-rbind(model1$results,model2$results,model3$results,model4$results,model5$results, model6$results,)
kfold_RMSE<-rbind(model1$results,model2$results,model3$results,model4$results,model5$results, model6$results)
kfold_RMSE$name<-rbind("model1","model2","model3", "model4", "model5","model6")
ggplot(kfold_RMSE, aes(x = name, y = RMSE)) + geom_line()+ geom_point()
